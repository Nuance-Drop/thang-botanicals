---
layout: default
title: Strain Finder | THANG Botanicals
---

<style>
  .quiz-container {
    max-width: 800px;
    margin: 0 auto;
    padding: 2rem 5%;
  }
  
  .progress-bar {
    height: 4px;
    background: rgba(255,255,255,0.1);
    border-radius: 2px;
    margin-bottom: 3rem;
    overflow: hidden;
  }
  
  .progress-fill {
    height: 100%;
    background: linear-gradient(90deg, var(--gold-primary), var(--accent-pink));
    width: 0%;
    transition: width 0.6s cubic-bezier(0.4, 0, 0.2, 1);
    box-shadow: 0 0 15px rgba(255, 0, 110, 0.5);
  }
  
  .question {
    display: none;
    animation: fadeIn 0.5s ease-out;
  }
  
  .question.active { display: block; }
  
  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(30px); }
    to { opacity: 1; transform: translateY(0); }
  }
  
  .question h2 {
    font-family: 'Cinzel', serif;
    font-size: 1.8rem;
    margin-bottom: 0.5rem;
    color: var(--gold-primary);
    text-transform: uppercase;
    letter-spacing: 0.05em;
  }
  
  .question-subtitle {
    color: rgba(255,255,255,0.6);
    font-family: 'Inter', sans-serif;
    margin-bottom: 2rem;
    font-size: 1.1rem;
  }
  
  .options {
    display: grid;
    gap: 1rem;
  }
  
  .option {
    padding: 1.5rem;
    background: rgba(255,255,255,0.03);
    border: 1px solid rgba(255,255,255,0.1);
    border-radius: 12px;
    cursor: pointer;
    transition: all 0.3s ease;
    font-family: 'Inter', sans-serif;
    font-size: 1.1rem;
    position: relative;
    overflow: hidden;
  }
  
  .option:hover {
    background: rgba(255,0,110,0.08);
    border-color: var(--accent-pink);
    transform: translateX(8px);
    box-shadow: 0 0 30px rgba(255,0,110,0.15);
  }
  
  .option::before {
    content: '';
    position: absolute;
    left: 0;
    top: 0;
    height: 100%;
    width: 3px;
    background: var(--accent-pink);
    opacity: 0;
    transition: opacity 0.3s;
  }
  
  .option:hover::before {
    opacity: 1;
  }
  
  .option strong {
    display: block;
    color: var(--gold-primary);
    margin-bottom: 0.3rem;
    font-family: 'Cinzel', serif;
  }
  
  .option small {
    color: rgba(255,255,255,0.6);
    font-size: 0.9rem;
  }
  
  #results {
    display: none;
    animation: fadeIn 0.6s ease-out;
  }
  
  .result-card-wrapper {
    display: block;
    text-decoration: none;
    color: inherit;
    margin-bottom: 1.5rem;
    transition: transform 0.3s ease;
  }
  
  .result-card-wrapper:hover {
    transform: translateY(-5px);
  }
  
  .result-card {
    background: linear-gradient(135deg, rgba(26,26,46,0.9), rgba(22,33,62,0.9));
    border: 1px solid rgba(255,215,0,0.2);
    border-radius: 16px;
    padding: 2rem;
    position: relative;
    backdrop-filter: blur(10px);
    cursor: pointer;
    transition: all 0.3s ease;
  }
  
  .result-card:hover {
    border-color: var(--gold-primary);
    box-shadow: 0 10px 40px rgba(255,215,0,0.15);
  }
  
  .result-card.top-match {
    border-color: var(--gold-primary);
    box-shadow: 0 0 40px rgba(255,215,0,0.2);
    background: linear-gradient(135deg, rgba(26,26,46,0.95), rgba(32,42,72,0.95));
  }
  
  .click-header {
    text-align: center;
    color: var(--gold-primary);
    font-family: 'Cinzel', serif;
    font-size: 0.85rem;
    text-transform: uppercase;
    letter-spacing: 0.2em;
    margin-bottom: 1rem;
    padding: 0.5rem;
    border: 1px solid rgba(255,215,0,0.3);
    border-radius: 4px;
    background: rgba(255,215,0,0.05);
  }
  
  .match-score {
    position: absolute;
    top: 1.5rem;
    right: 1.5rem;
    background: linear-gradient(135deg, var(--accent-pink), #ff006e);
    color: white;
    padding: 0.4rem 1rem;
    border-radius: 20px;
    font-family: 'Cinzel', serif;
    font-size: 0.75rem;
    font-weight: bold;
  }
  
  .strain-badges {
    display: flex;
    gap: 0.5rem;
    margin-bottom: 1rem;
    flex-wrap: wrap;
  }
  
  .badge {
    padding: 0.2rem 0.6rem;
    border-radius: 12px;
    font-size: 0.7rem;
    font-family: 'Cinzel', serif;
    text-transform: uppercase;
    letter-spacing: 0.05em;
  }
  
  .badge-limited {
    background: rgba(255,0,0,0.2);
    border: 1px solid rgba(255,0,0,0.4);
    color: #ff4444;
  }
  
  .badge-premium {
    background: rgba(255,215,0,0.2);
    border: 1px solid rgba(255,215,0,0.4);
    color: var(--gold-primary);
  }
  
  .badge-beginner {
    background: rgba(0,255,136,0.1);
    border: 1px solid rgba(0,255,136,0.3);
    color: #00ff88;
  }
  
  .strain-meta {
    display: flex;
    gap: 1rem;
    margin: 0.5rem 0 1rem;
    font-family: 'Inter', sans-serif;
    color: var(--accent-cyan);
    font-size: 0.9rem;
    flex-wrap: wrap;
  }
  
  .strain-photo-placeholder {
    width: 100%;
    height: 160px;
    background: linear-gradient(135deg, rgba(0,0,0,0.3), rgba(255,255,255,0.05));
    border-radius: 8px;
    margin-bottom: 1rem;
    display: flex;
    align-items: center;
    justify-content: center;
    color: rgba(255,255,255,0.3);
    font-size: 0.9rem;
    border: 1px dashed rgba(255,255,255,0.2);
  }
  
  .strain-characteristics {
    display: flex;
    gap: 0.5rem;
    margin-top: 1rem;
    flex-wrap: wrap;
  }
  
  .char-tag {
    background: rgba(255,255,255,0.05);
    padding: 0.3rem 0.8rem;
    border-radius: 20px;
    font-size: 0.8rem;
    color: rgba(255,255,255,0.7);
    border: 1px solid rgba(255,255,255,0.1);
  }
  
  .results-actions {
    display: flex;
    gap: 1rem;
    justify-content: center;
    margin-top: 3rem;
    flex-wrap: wrap;
  }
  
  .btn-secondary {
    background: transparent;
    border: 1px solid rgba(255,255,255,0.2);
    color: white;
    padding: 1rem 2rem;
    font-family: 'Cinzel', serif;
    text-transform: uppercase;
    letter-spacing: 0.1em;
    cursor: pointer;
    transition: all 0.3s;
  }
  
  .btn-secondary:hover {
    border-color: var(--accent-pink);
    background: rgba(255,0,110,0.1);
  }
  
  .warning-box {
    background: rgba(255,193,7,0.1);
    border: 1px solid rgba(255,193,7,0.3);
    border-radius: 8px;
    padding: 1rem;
    margin-bottom: 2rem;
    color: #ffc107;
    font-family: 'Inter', sans-serif;
  }
  
  .warning-box strong {
    color: #fff;
    display: block;
    margin-bottom: 0.5rem;
  }
  
  .avoid-warning {
    background: rgba(255,0,0,0.1);
    border: 1px solid rgba(255,0,0,0.3);
    color: #ff6b6b;
    padding: 0.8rem;
    border-radius: 6px;
    margin-top: 1rem;
    font-size: 0.9rem;
  }
  
  @media (max-width: 600px) {
    .quiz-container {
      padding: 1rem;
    }
    
    .question h2 {
      font-size: 1.4rem;
    }
    
    .option {
      padding: 1rem;
    }
    
    .result-card {
      padding: 1.5rem;
    }
    
    .match-score {
      position: static;
      display: inline-block;
      margin-bottom: 1rem;
    }
  }
</style>

<div class="quiz-container">
  <div class="progress-bar">
    <div class="progress-fill" id="progress"></div>
  </div>
  
  <div class="question active" data-q="0">
    <h2>Experience Level</h2>
    <div class="question-subtitle">This determines which strains we show you. Safety first—some strains are not for beginners.</div>
    <div class="options">
      <div class="option" onclick="answer('experience', 'beginner')">
        <strong>First Timer</strong>
        <small>New to botanicals or kratom specifically</small>
      </div>
      <div class="option" onclick="answer('experience', 'moderate')">
        <strong>Some Experience</strong>
        <small>Tried a few strains, know the basics, 6+ months use</small>
      </div>
      <div class="option" onclick="answer('experience', 'experienced')">
        <strong>Connoisseur</strong>
        <small>Years of experience, know your veins, regions, and dosing</small>
      </div>
    </div>
  </div>
  
  <div class="question" data-q="1">
    <h2>What are you seeking?</h2>
    <div class="question-subtitle">Different strains have different "personalities"</div>
    <div class="options">
      <div class="option" onclick="answer('intent', 'energy')">
        <strong>Clean Energy & Focus</strong>
        <small>Coffee replacement, productivity, mental clarity (nootropic)</small>
      </div>
      <div class="option" onclick="answer('intent', 'social')">
        <strong>Social Euphoria</strong>
        <small>Upbeat, talkative, mood lift for social settings</small>
      </div>
      <div class="option" onclick="answer('intent', 'relax')">
        <strong>Deep Relaxation</strong>
        <small>Couch-lock, sedating, heavy relief for evening</small>
      </div>
      <div class="option" onclick="answer('intent', 'relief')">
        <strong>Pain & Anxiety Relief</strong>
        <small>Therapeutic use, comfort, taking the edge off without sedation</small>
      </div>
      <div class="option" onclick="answer('intent', 'balance')">
        <strong>Balanced All-Rounder</strong>
        <small>Jack of all trades—good for any situation</small>
      </div>
    </div>
  </div>
  
  <div class="question" data-q="2">
    <h2>When do you prefer?</h2>
    <div class="question-subtitle">Some strains are too stimulating or sedating for certain times</div>
    <div class="options">
      <div class="option" onclick="answer('time', 'morning')">
        <strong>Morning</strong>
        <small>Start the day, replace coffee, get going</small>
      </div>
      <div class="option" onclick="answer('time', 'afternoon')">
        <strong>Afternoon</strong>
        <small>Mid-day boost or social situations</small>
      </div>
      <div class="option" onclick="answer('time', 'evening')">
        <strong>Evening</strong>
        <small>Wind down, relax, socialize at night, sleep prep</small>
      </div>
      <div class="option" onclick="answer('time', 'anytime')">
        <strong>Anytime</strong>
        <small>Flexible—need something that works whenever</small>
      </div>
    </div>
  </div>
  
  <div class="question" data-q="3">
    <h2>Preferred Intensity</h2>
    <div class="question-subtitle">How fast and hard should it hit?</div>
    <div class="options">
      <div class="option" onclick="answer('speed', 'gentle')">
        <strong>Gentle & Smooth</strong>
        <small>Slow onset, manageable, subtle—easy on the stomach</small>
      </div>
      <div class="option" onclick="answer('speed', 'moderate')">
        <strong>Balanced & Moderate</strong>
        <small>Middle of the road, predictable, reliable</small>
      </div>
      <div class="option" onclick="answer('speed', 'fast')">
        <strong>Fast & Potent</strong>
        <small>Quick onset, strong effects, espresso-style kick</small>
      </div>
    </div>
  </div>
  
  <div class="question" data-q="4">
    <h2>Health Considerations</h2>
    <div class="question-subtitle">Help us filter for your safety (optional)</div>
    <div class="options">
      <div class="option" onclick="answer('health', 'sensitive')">
        <strong>Sensitive Stomach</strong>
        <small>Prone to nausea—need gentle, fermented, or smooth strains</small>
      </div>
      <div class="option" onclick="answer('health', 'anxiety')">
        <strong>Prone to Anxiety</strong>
        <small>Avoid overly stimulating strains that might cause jitters</small>
      </div>
      <div class="option" onclick="answer('health', 'none')">
        <strong>No Special Concerns</strong>
        <small>Standard tolerance, no known sensitivities</small>
      </div>
    </div>
  </div>
  
  <div id="results">
    <div class="warning-box" id="beginner-warning" style="display: none;">
      <strong>⚠️ Beginner Safety Notice</strong>
      We've filtered out high-potency strains. Start low and slow. If a strain makes you nauseous, try a smaller amount or switch to a gentler variety like Yellow Thai or Red Bentuangie.
    </div>
    
    <h2 style="font-family: 'Cinzel', serif; color: var(--gold-primary); margin-bottom: 2rem; text-align: center;">
      Your Top 3 Matches
    </h2>
    
    <div id="resultContainer"></div>
    
    <div class="results-actions">
      <button class="btn-secondary" onclick="resetQuiz()">Retake Quiz</button>
      <a href="{{ '/catalog' | relative_url }}" class="btn-gold" style="text-decoration: none; display: inline-block;">View Full Catalog</a>
    </div>
  </div>
</div>

<script>
const strains = [
  { 
    name: "Green Aceh", 
    slug: "green-aceh",
    color: "green", 
    speed: "balanced", 
    experience: "experienced",
    time: ["morning","afternoon","evening"], 
    intent: ["social", "energy"],
    potency: 9,
    limited: false,
    premium: true,
    desc: "Intense, vital, rare. Upbeat social characteristics. Seriously more intense—requires experience.",
    avoidIf: ["beginner", "sensitive"],
    stats: { energy: 8, focus: 6, pain: 5, anxiety: 4, social: 9 }
  },
  { 
    name: "Green Dragon", 
    slug: "green-dragon",
    color: "green", 
    speed: "balanced", 
    experience: "beginner",
    time: ["morning","afternoon"], 
    intent: ["social", "balance"],
    potency: 6,
    limited: false,
    premium: false,
    desc: "Euphoric and happy. Balanced for social or solo use. Comparable to Green Malay.",
    avoidIf: [],
    stats: { energy: 6, focus: 5, pain: 4, anxiety: 6, social: 8 }
  },
  { 
    name: "Green Maeng Da", 
    slug: "green-maeng-da",
    color: "green", 
    speed: "fast", 
    experience: "moderate",
    time: ["morning","afternoon"], 
    intent: ["energy", "focus"],
    potency: 8,
    limited: false,
    premium: false,
    desc: "The gold standard. High productivity strain. Stronger than typical greens.",
    avoidIf: ["sensitive"],
    stats: { energy: 9, focus: 8, pain: 6, anxiety: 5, social: 5 }
  },
  { 
    name: "Green Malay", 
    slug: "green-malay",
    color: "green", 
    speed: "balanced", 
    experience: "beginner",
    time: ["morning","afternoon","evening"], 
    intent: ["balance", "social"],
    potency: 6,
    limited: false,
    premium: false,
    desc: "Long duration, strong and versatile. Chill yet functional.",
    avoidIf: [],
    stats: { energy: 6, focus: 6, pain: 5, anxiety: 6, social: 7 }
  },
  { 
    name: "Super Green", 
    slug: "super-green",
    color: "green", 
    speed: "fast", 
    experience: "experienced",
    time: ["morning"], 
    intent: ["energy"],
    potency: 10,
    limited: false,
    premium: false,
    desc: "Maximum potency blend. Like espresso. For those who need serious energy.",
    avoidIf: ["beginner", "anxiety", "sensitive"],
    stats: { energy: 10, focus: 7, pain: 4, anxiety: 3, social: 4 }
  },
  { 
    name: "Green Thai", 
    slug: "green-thai",
    color: "green", 
    speed: "moderate", 
    experience: "beginner",
    time: ["morning","afternoon"], 
    intent: ["relief", "energy"],
    potency: 5,
    limited: false,
    premium: false,
    desc: "Traditional profile. Calm energy, good for discomfort. Moderate speed.",
    avoidIf: [],
    stats: { energy: 6, focus: 5, pain: 7, anxiety: 6, social: 5 }
  },
  { 
    name: "Green Dracula", 
    slug: "green-dracula",
    color: "green", 
    speed: "fast", 
    experience: "experienced",
    time: ["afternoon","evening"], 
    intent: ["social", "energy"],
    potency: 8,
    limited: true,
    premium: false,
    desc: "Exclusive limited collector's strain. Unique opportunity, not daily driver.",
    avoidIf: ["beginner"],
    stats: { energy: 8, focus: 6, pain: 4, anxiety: 5, social: 8 }
  },
  { 
    name: "Red Aceh", 
    slug: "red-aceh",
    color: "red", 
    speed: "slow", 
    experience: "experienced",
    time: ["evening"], 
    intent: ["relax", "relief"],
    potency: 9,
    limited: false,
    premium: true,
    desc: "Couch-lock sedating. Heavy relief. Best for deep relaxation.",
    avoidIf: ["beginner"],
    stats: { energy: 2, focus: 3, pain: 9, anxiety: 8, social: 3 }
  },
  { 
    name: "Red Thai", 
    slug: "red-thai",
    color: "red", 
    speed: "slow", 
    experience: "beginner",
    time: ["afternoon","evening"], 
    intent: ["balance", "relief"],
    potency: 4,
    limited: false,
    premium: false,
    desc: "Traditional red profile. Slow creeper. Manageable during day or night.",
    avoidIf: [],
    stats: { energy: 3, focus: 4, pain: 6, anxiety: 7, social: 5 }
  },
  { 
    name: "Red Dragon", 
    slug: "red-dragon",
    color: "red", 
    speed: "moderate", 
    experience: "beginner",
    time: ["evening"], 
    intent: ["social"],
    potency: 6,
    limited: false,
    premium: false,
    desc: "Aphrodisiac and socializing qualities. Different from Green Dragon.",
    avoidIf: [],
    stats: { energy: 5, focus: 5, pain: 4, anxiety: 6, social: 9 }
  },
  { 
    name: "Red Bali", 
    slug: "red-bali",
    color: "red", 
    speed: "slow", 
    experience: "beginner",
    time: ["evening"], 
    intent: ["relax", "relief"],
    potency: 7,
    limited: false,
    premium: false,
    desc: "Classic feel. Best for relief, purely sedating. The standard red.",
    avoidIf: [],
    stats: { energy: 2, focus: 3, pain: 9, anxiety: 7, social: 3 }
  },
  { 
    name: "Red Maeng Da", 
    slug: "red-maeng-da",
    color: "red", 
    speed: "moderate", 
    experience: "moderate",
    time: ["afternoon"], 
    intent: ["balance", "relief"],
    potency: 7,
    limited: false,
    premium: false,
    desc: "Premium red. Stronger than typical reds. Middle-ground energy.",
    avoidIf: [],
    stats: { energy: 5, focus: 5, pain: 8, anxiety: 6, social: 5 }
  },
  { 
    name: "Red Bentuangie", 
    slug: "red-bentuangie",
    color: "red", 
    speed: "slow", 
    experience: "beginner",
    time: ["evening"], 
    intent: ["relax"],
    potency: 6,
    limited: true,
    premium: false,
    desc: "Fermented. Best taste, smooth, no tummy upset. Gentle sedation.",
    avoidIf: [],
    stats: { energy: 2, focus: 3, pain: 7, anxiety: 8, social: 4 }
  },
  { 
    name: "White Maeng Da", 
    slug: "white-maeng-da",
    color: "white", 
    speed: "fast", 
    experience: "beginner",
    time: ["morning"], 
    intent: ["energy", "focus"],
    potency: 8,
    limited: false,
    premium: false,
    desc: "Fast energy. Perfect coffee replacement. Clean stimulation.",
    avoidIf: ["anxiety"],
    stats: { energy: 9, focus: 8, pain: 3, anxiety: 4, social: 5 }
  },
  { 
    name: "White Aceh", 
    slug: "white-aceh",
    color: "white", 
    speed: "fast", 
    experience: "experienced",
    time: ["morning","afternoon"], 
    intent: ["energy"],
    potency: 9,
    limited: false,
    premium: true,
    desc: "Smooth but intense. Medium duration. Stronger than White MD.",
    avoidIf: ["beginner", "anxiety"],
    stats: { energy: 9, focus: 7, pain: 4, anxiety: 3, social: 6 }
  },
  { 
    name: "White Horn", 
    slug: "white-horn",
    color: "white", 
    speed: "fast", 
    experience: "experienced",
    time: ["morning"], 
    intent: ["energy"],
    potency: 8,
    limited: false,
    premium: false,
    desc: "Premium energetic profile. Not smooth come-up, but potent.",
    avoidIf: ["beginner", "anxiety", "sensitive"],
    stats: { energy: 9, focus: 6, pain: 3, anxiety: 3, social: 5 }
  },
  { 
    name: "White Sumatra", 
    slug: "white-sumatra",
    color: "white", 
    speed: "moderate", 
    experience: "beginner",
    time: ["morning"], 
    intent: ["focus"],
    potency: 6,
    limited: false,
    premium: false,
    desc: "Lighter regional variety. Good for concentration without jitters.",
    avoidIf: [],
    stats: { energy: 6, focus: 8, pain: 3, anxiety: 6, social: 4 }
  },
  { 
    name: "White Elephant", 
    slug: "white-elephant",
    color: "white", 
    speed: "moderate", 
    experience: "beginner",
    time: ["morning","afternoon"], 
    intent: ["balance", "energy"],
    potency: 7,
    limited: false,
    premium: false,
    desc: "Unusual large leaf type. Strong profile but manageable.",
    avoidIf: [],
    stats: { energy: 7, focus: 6, pain: 4, anxiety: 5, social: 6 }
  },
  { 
    name: "White Zombie", 
    slug: "white-zombie",
    color: "white", 
    speed: "fast", 
    experience: "beginner",
    time: ["morning"], 
    intent: ["energy", "social"],
    potency: 7,
    limited: true,
    premium: false,
    desc: "Exclusive novelty strain. Named after the band. Rare collector item.",
    avoidIf: ["anxiety"],
    stats: { energy: 8, focus: 6, pain: 3, anxiety: 4, social: 7 }
  },
  { 
    name: "Yellow Dragon", 
    slug: "yellow-dragon",
    color: "yellow", 
    speed: "balanced", 
    experience: "beginner",
    time: ["evening"], 
    intent: ["social", "relief"],
    potency: 5,
    limited: false,
    premium: false,
    desc: "Euphoric mix characteristics. More euphoric than other yellows.",
    avoidIf: [],
    stats: { energy: 5, focus: 5, pain: 5, anxiety: 7, social: 8 }
  },
  { 
    name: "Yellow Hulu", 
    slug: "yellow-hulu",
    color: "yellow", 
    speed: "moderate", 
    experience: "beginner",
    time: ["afternoon"], 
    intent: ["relief"],
    potency: 5,
    limited: false,
    premium: false,
    desc: "Kapuas region. Anxiolytic properties. Medium duration.",
    avoidIf: [],
    stats: { energy: 4, focus: 5, pain: 5, anxiety: 8, social: 5 }
  },
  { 
    name: "Yellow Vietnam", 
    slug: "yellow-vietnam",
    color: "yellow", 
    speed: "moderate", 
    experience: "beginner",
    time: ["morning","afternoon"], 
    intent: ["relief", "focus"],
    potency: 6,
    limited: false,
    premium: false,
    desc: "Anxiety relief without sedation. Rare regional variety.",
    avoidIf: [],
    stats: { energy: 6, focus: 7, pain: 4, anxiety: 9, social: 5 }
  },
  { 
    name: "Yellow Maeng Da", 
    slug: "yellow-maeng-da",
    color: "yellow", 
    speed: "balanced", 
    experience: "beginner",
    time: ["afternoon"], 
    intent: ["balance"],
    potency: 5,
    limited: false,
    premium: false,
    desc: "Premium drying process. Great balance of all characteristics.",
    avoidIf: [],
    stats: { energy: 6, focus: 6, pain: 5, anxiety: 7, social: 6 }
  },
  { 
    name: "Yellow Thai", 
    slug: "yellow-thai",
    color: "yellow", 
    speed: "moderate", 
    experience: "beginner",
    time: ["evening"], 
    intent: ["relief", "relax"],
    potency: 5,
    limited: true,
    premium: false,
    desc: "Traditional method. Gentle but strong anxiolytic. Take the edge off.",
    avoidIf: [],
    stats: { energy: 3, focus: 4, pain: 6, anxiety: 9, social: 5 }
  }
];

let answers = {};
let currentQ = 0;
const totalQ = 5;

function answer(category, value) {
  answers[category] = value;
  
  const progress = ((currentQ + 1) / totalQ) * 100;
  document.getElementById('progress').style.width = progress + '%';

  const questions = document.querySelectorAll('.question');
  questions[currentQ].classList.remove('active');
  
  if (currentQ < totalQ - 1) {
    currentQ++;
    questions[currentQ].classList.add('active');
  } else {
    showResults();
  }
}

function calculateScores() {
  return strains.map(strain => {
    let score = 0;
    let reasons = [];
    let warnings = [];
    
    if (answers.experience === 'beginner') {
      if (strain.experience === 'experienced') {
        return { strain, score: -999, reasons: [], warnings: [] };
      }
      if (strain.experience === 'beginner') {
        score += 40;
        reasons.push("Perfect for beginners");
      } else {
        score += 20;
      }
    } else if (answers.experience === 'experienced') {
      if (strain.experience === 'experienced') {
        score += 35;
        reasons.push("Connoisseur grade");
      } else {
        score += 15;
      }
    } else {
      if (strain.experience === 'moderate') {
        score += 30;
      } else {
        score += 20;
      }
    }
    
    if (answers.health === 'sensitive') {
      if (strain.avoidIf.includes('sensitive')) {
        score -= 50;
        warnings.push("May cause nausea—start very small");
      }
      if (strain.name.includes('Bentuangie') || strain.speed === 'slow' || strain.potency <= 5) {
        score += 20;
        reasons.push("Gentle on stomach");
      }
    }
    
    if (answers.health === 'anxiety') {
      if (strain.avoidIf.includes('anxiety')) {
        score -= 60;
        warnings.push("May increase anxiety—avoid if sensitive");
      }
      if (strain.color === 'yellow' || (strain.color === 'red' && strain.speed === 'slow')) {
        score += 15;
        reasons.push("Anxiety-friendly");
      }
    }
    
    const intentWeights = {
      'energy': 30,
      'social': 30,
      'relax': 35,
      'relief': 35,
      'balance': 25,
      'focus': 30
    };
    
    if (strain.intent.includes(answers.intent)) {
      score += intentWeights[answers.intent] || 25;
      reasons.push(`Great for ${answers.intent}`);
      
      if (answers.intent === 'energy' && strain.potency >= 7) score += 10;
      if (answers.intent === 'relax' && strain.speed === 'slow') score += 10;
    }
    
    if (strain.time.includes(answers.time)) {
      score += 25;
      reasons.push(`Perfect for ${answers.time}`);
    } else if (answers.time === 'anytime' && strain.time.length >= 3) {
      score += 20;
      reasons.push("Flexible timing");
    } else if (answers.time === 'evening' && strain.time.includes('afternoon')) {
      score += 10;
    }
    
    if (answers.speed === 'gentle') {
      if (strain.speed === 'slow') score += 25;
      else if (strain.speed === 'moderate') score += 15;
      else if (strain.speed === 'fast') {
        if (strain.potency > 7) score -= 15;
        else score += 5;
      }
    } else if (answers.speed === 'moderate') {
      if (strain.speed === 'moderate') score += 25;
      else if (strain.speed === 'balanced') score += 20;
      else score += 10;
    } else if (answers.speed === 'fast') {
      if (strain.speed === 'fast') score += 30;
      else if (strain.potency >= 8) score += 15;
      else score += 5;
    }
    
    if (answers.time === 'evening' && strain.color === 'white' && strain.speed === 'fast') {
      score -= 25;
      warnings.push("Too stimulating for evening");
    }
    if (answers.time === 'morning' && strain.color === 'red' && strain.speed === 'slow') {
      score -= 20;
      warnings.push("Too sedating for morning");
    }
    if (answers.time === 'evening' && strain.color === 'green' && strain.speed === 'fast' && answers.intent !== 'social') {
      score -= 15;
    }
    
    if (strain.premium) score += 5;
    if (strain.limited) score += 3;
    
    return { strain, score, reasons, warnings };
  }).filter(match => match.score > 0)
    .sort((a, b) => b.score - a.score);
}

function showResults() {
  document.getElementById('results').style.display = 'block';
  
  if (answers.experience === 'beginner') {
    document.getElementById('beginner-warning').style.display = 'block';
  }
  
  const matches = calculateScores();
  const topMatches = matches.slice(0, 3);
  const container = document.getElementById('resultContainer');
  
  if (topMatches.length === 0) {
    container.innerHTML = `
      <div class="warning-box">
        <strong>No perfect matches found</strong>
        Try adjusting your preferences or <a href="/catalog" style="color: var(--gold-primary);">browse the full catalog</a>.
      </div>
    `;
    return;
  }
  
  const highestScore = Math.max(...matches.map(m => m.score));
  
  container.innerHTML = topMatches.map((match, i) => {
    const isTop = i === 0;
    const s = match.strain;
    
    let matchPercent = Math.round((match.score / highestScore) * 95);
    matchPercent = Math.min(99, Math.max(60, matchPercent));
    if (isTop) matchPercent = Math.min(99, matchPercent + 4);
    
    const colorMap = {
      'green': '#00ff88',
      'red': '#ff4444', 
      'white': '#ffffff',
      'yellow': '#ffd700'
    };
    const accentColor = colorMap[s.color] || 'var(--accent-cyan)';
    
    const warningsHtml = match.warnings.length > 0 ? 
      `<div class="avoid-warning">⚠️ ${match.warnings.join(' • ')}</div>` : '';
    
    return `
      <a href="/strains/${s.slug}/" class="result-card-wrapper">
        <div class="result-card ${isTop ? 'top-match' : ''}">
          <div class="click-footer">Click for Full Details →</div>
          <div class="match-score">${matchPercent}% Match</div>
          <div class="strain-badges">
            ${s.limited ? '<span class="badge badge-limited">Limited Stock</span>' : ''}
            ${s.premium ? '<span class="badge badge-premium">Premium +$15</span>' : ''}
            ${s.experience === 'beginner' ? '<span class="badge badge-beginner">Beginner Safe</span>' : ''}
            <span class="badge" style="background: ${accentColor}20; border: 1px solid ${accentColor}40; color: ${accentColor}; text-transform: capitalize;">${s.color}</span>
          </div>
          <div class="strain-photo-placeholder">[Photo: ${s.name}]</div>
          <h3 style="font-family: 'Cinzel', serif; font-size: 1.8rem; margin: 0 0 0.5rem; color: #fff;">${s.name}</h3>
          <div class="strain-meta">
            <span style="text-transform: capitalize">${s.speed} onset</span>
            <span>•</span>
            <span>Potency: ${s.potency}/10</span>
            <span>•</span>
            <span>Best: ${s.time.join(', ')}</span>
          </div>
          <p style="color: rgba(255,255,255,0.85); line-height: 1.6; font-size: 1.05rem; margin: 1rem 0;">${s.desc}</p>
          <div class="strain-characteristics">
            <span class="char-tag">E:${s.stats.energy}</span>
            <span class="char-tag">F:${s.stats.focus}</span>
            <span class="char-tag">P:${s.stats.pain}</span>
          </div>
          ${warningsHtml}
        </div>
      </a>
    `;
  }).join('');
  
  setTimeout(() => {
    document.getElementById('results').scrollIntoView({ behavior: 'smooth', block: 'start' });
  }, 100);
}

function resetQuiz() {
  currentQ = 0;
  answers = {};
  document.getElementById('progress').style.width = '0%';
  document.getElementById('results').style.display = 'none';
  document.getElementById('beginner-warning').style.display = 'none';
  
  const questions = document.querySelectorAll('.question');
  questions.forEach((q, i) => {
    q.classList.toggle('active', i === 0);
  });
  
  window.scrollTo({ top: 0, behavior: 'smooth' });
}
</script>